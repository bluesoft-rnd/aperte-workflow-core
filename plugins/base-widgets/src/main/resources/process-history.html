<#assign processLogs = process.getProcessLogsSortedByDate()?reverse!""/>

<div>
    <div class="panel panel-default">
        <div class="panel-heading">${messageSource.getMessage("widget.process_history.name")}</div>
        <div class="panel-body form-inline">
            <ul class="list-group aperte-list-group">
                <#list processLogs as log>
                    <#switch log.getLogType()>
                        <#case "PROCESS_CHANGE">
                            <#break>
                        <#case "INFO">
                            <li class="list-group-item">
                                <h4 class="list-group-item-heading" style="font-size: 16px;">
                                    <strong>
                                        ${log.getFormattedDate("dd-MM-yy HH:mm:ss")} :
                                    </strong>
                                    ${messageSource.getMessage(log.getEventI18NKey())}
                                </h4>
                                <p class="list-group-item-text" style="font-size: 15px;">
                                    <#assign messageParameters = log.getAdditionalInfo()?split(",")/>
                                    ${messageSource.getMessage(log.getLogValue(), "", messageParameters)}
                                </p>
                            </li>
                            <#break>
                        <#default>
                            <li class="list-group-item">
                                <#assign actionUser = userSource.getUserByLogin(log.getUserLogin())!""/>
                                <#assign substitutionUserLogin = log.getUserSubstituteLogin()!""/>
                                <h4 class="list-group-item-heading" style="font-size: 16px;">
                                    <strong>
                                        ${log.getFormattedDate("dd-MM-yy HH:mm:ss")} :
                                    </strong>
                                    ${messageSource.getMessage(log.getEventI18NKey())}
                                    <#assign entryDescription = log.getAdditionalInfo()!log.getLogValue()!""/>
                                    <#if entryDescription != "">
                                        -  ${messageSource.getMessage(entryDescription)}
                                    </#if>
                                </h4>
                                <p class="list-group-item-text" style="font-size: 15px;">
                                    <strong>${messageSource.getMessage("process.history.action.by")}: </strong>

                                    ${actionUser.getRealName()} ( ${log.getUserLogin()} )
                                    <#if substitutionUserLogin != "">
                                        <#assign substitutionUser = userSource.getUserByLogin(substitutionUserLogin)!""/>
                                        ${messageSource.getMessage("process.history.subsituted.by")} :
                                        ${substitutionUser.getRealName()} ( ${substitutionUserLogin} )
                                    </#if>

                                </p>
                                <p class="list-group-item-text ">

                                    <#assign state = log.getState()!""/>
                                    <#if state != "">
                                        <#assign stateDesc = state.getDescription()!state.getName()!""/>
                                        <strong>${messageSource.getMessage("process.history.new.state")}:</strong>

                                        ${messageSource.getMessage(stateDesc)}
                                    </#if>
                                </p>
                            </li>
                    </#switch>
                </#list>
            </ul>
        </div>
    </div>
</div>




